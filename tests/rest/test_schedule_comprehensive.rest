###
# Schedule Management API Comprehensive Test Suite
# Pet Care Service Backend - Schedule Routes Testing
###

### Variables
@baseUrl = http://localhost:8383
@userToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsInVzZXJuYW1lIjoidGVzdF91c2VyIiwicm9sZSI6IlBldCBvd25lciIsImlhdCI6MTczNDM2MjU5MX0.Ht9bvKvOT1cKiMPeovQP-qS9DZAcCZGIXNBiIJHCfcY
@contentType = application/json

### Test Data Setup - Create Test Pet for Schedule Testing
POST {{baseUrl}}/api/pets
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "name": "Schedule Test Pet",
  "age": 3,
  "breed": "Golden Retriever",
  "species": "Dog",
  "gender": "Male",
  "weight": 30.5,
  "allergies": "None",
  "medical_history": "Regular checkups"
}

### Store Pet ID for testing (use petId from response)

### Create Test Diet for Schedule
POST {{baseUrl}}/api/diet
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "name": "Morning Kibble",
  "brand": "Premium Dog Food",
  "quantity": "2 cups",
  "frequency": "Daily",
  "notes": "With chicken flavor"
}

### Store Diet ID for testing (use dietId from response)

### Create Test Activity for Schedule
POST {{baseUrl}}/api/activity/pet/1
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "name": "Morning Walk",
  "description": "30-minute walk in the park"
}

### Store Activity ID for testing (use activityId from response)

###
# SCHEDULE MANAGEMENT TESTS
###

### 1. GET All Schedules (Empty initially)
GET {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}

### 2. Create Diet Schedule - Daily Feeding
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

### 3. Create Activity Schedule - Daily Walk
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "activityId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 7,
  "minute": 30
}

### 4. Create Weekly Schedule - Vet Visit
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "activityId": 1,
  "startdate": "2025-06-15",
  "repeat_option": "weekly",
  "hour": 14,
  "minute": 0
}

### 5. GET All Schedules (Should show created schedules)
GET {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}

### 6. GET Schedules for Specific Pet
GET {{baseUrl}}/api/schedule/pet/1
Authorization: Bearer {{userToken}}

### 7. GET Specific Schedule by ID
GET {{baseUrl}}/api/schedule/1
Authorization: Bearer {{userToken}}

### 8. Update Schedule - Change time
PUT {{baseUrl}}/api/schedule/1
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "hour": 9,
  "minute": 15,
  "repeat_option": "daily"
}

### 9. Update Schedule - Change date and repeat
PUT {{baseUrl}}/api/schedule/2
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "startdate": "2025-06-09",
  "repeat_option": "weekly"
}

###
# VALIDATION TESTS
###

### 10. Invalid Schedule Creation - Missing required fields
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1
}

### 11. Invalid Schedule Creation - Invalid hour
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 25,
  "minute": 0
}

### 12. Invalid Schedule Creation - Invalid minute
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 60
}

### 13. Invalid Schedule Creation - Invalid date format
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025/06/08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

### 14. Invalid Schedule Creation - Invalid repeat option
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "hourly",
  "hour": 8,
  "minute": 0
}

### 15. Invalid Schedule Creation - Both dietId and activityId
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "activityId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

### 16. Invalid Schedule Creation - Neither dietId nor activityId
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

###
# AUTHORIZATION TESTS
###

### 17. Access without token
GET {{baseUrl}}/api/schedule

### 18. Create schedule without token
POST {{baseUrl}}/api/schedule
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

### 19. Invalid token
GET {{baseUrl}}/api/schedule
Authorization: Bearer invalid_token

###
# EDGE CASES
###

### 20. Access schedule for non-existent pet
GET {{baseUrl}}/api/schedule/pet/999
Authorization: Bearer {{userToken}}

### 21. Access non-existent schedule
GET {{baseUrl}}/api/schedule/999
Authorization: Bearer {{userToken}}

### 22. Update non-existent schedule
PUT {{baseUrl}}/api/schedule/999
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "hour": 10
}

### 23. Delete non-existent schedule
DELETE {{baseUrl}}/api/schedule/999
Authorization: Bearer {{userToken}}

### 24. Create schedule for non-existent pet
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 999,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

### 25. Create schedule with non-existent diet
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 999,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

### 26. Create schedule with non-existent activity
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "activityId": 999,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 8,
  "minute": 0
}

###
# COMPREHENSIVE SCHEDULE SCENARIOS
###

### 27. Create Multiple Schedules for Same Pet
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 18,
  "minute": 0
}

### 28. Create Monthly Schedule
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "activityId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "monthly",
  "hour": 10,
  "minute": 30
}

### 29. Create Never-Repeating Schedule (One-time event)
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "activityId": 1,
  "startdate": "2025-12-25",
  "repeat_option": "never",
  "hour": 16,
  "minute": 0
}

### 30. Verify All Schedules Created
GET {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}

###
# CLEANUP TESTS
###

### 31. Delete Schedule
DELETE {{baseUrl}}/api/schedule/1
Authorization: Bearer {{userToken}}

### 32. Verify Schedule Deleted
GET {{baseUrl}}/api/schedule/1
Authorization: Bearer {{userToken}}

### 33. Delete Multiple Schedules
DELETE {{baseUrl}}/api/schedule/2
Authorization: Bearer {{userToken}}

DELETE {{baseUrl}}/api/schedule/3
Authorization: Bearer {{userToken}}

### 34. Final Schedule List Check
GET {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}

###
# PERFORMANCE AND BOUNDARY TESTS
###

### 35. Extreme Time Values (Valid boundaries)
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 0,
  "minute": 0
}

### 36. Maximum Time Values
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2025-06-08",
  "repeat_option": "daily",
  "hour": 23,
  "minute": 59
}

### 37. Future Date Schedule
POST {{baseUrl}}/api/schedule
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

{
  "petId": 1,
  "dietId": 1,
  "startdate": "2026-01-15",
  "repeat_option": "weekly",
  "hour": 12,
  "minute": 30
}

### End of Schedule Management Tests